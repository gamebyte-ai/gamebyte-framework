<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ResultScreen Demo - GameByte Framework</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { overflow: hidden; background: #1a1a2e; }
        canvas { display: block; margin: 0 auto; }
    </style>
</head>
<body>
    <script src="https://cdn.jsdelivr.net/npm/pixi.js@8/dist/pixi.min.js"></script>
    <script src="/gamebyte.umd.js"></script>

    <script>
        const { createGame, CelebrationManager } = GameByteFramework;

        const CONFIG = { width: 360, height: 700 };
        const COLORS = {
            darkBg: 0x1a1a2e,
            panelBg: 0x2a4a7a,
            panelLight: 0x4a7ab0,
            panelBorder: 0x1a3050,
            ribbonBlue: 0x3a8ad0,
            ribbonDark: 0x2a6aa0,
            greenBtn: 0x5cb85c,
            greenBtnDark: 0x449d44,
            orangeBtn: 0xf0ad4e,
            orangeBtnDark: 0xd9963a,
            textWhite: 0xffffff,
            textOutline: 0x2a2a4a
        };

        const canvas = document.createElement('canvas');
        canvas.width = CONFIG.width;
        canvas.height = CONFIG.height;
        document.body.appendChild(canvas);

        const game = createGame();
        let celebration = null;

        (async () => {
            await game.initialize(canvas, '2d');
            const renderer = game.make('renderer');
            const stage = renderer.getStage();

            celebration = new CelebrationManager(stage, CONFIG.width, CONFIG.height);

            function createVictoryScreen() {
                // Clear stage
                while (stage.children.length > 0) {
                    stage.removeChildAt(0);
                }
                celebration.clear();

                const centerX = CONFIG.width / 2;

                // ===== DARK BACKGROUND =====
                const bg = new PIXI.Graphics();
                bg.rect(0, 0, CONFIG.width, CONFIG.height);
                bg.fill(COLORS.darkBg);
                stage.addChild(bg);

                // ===== TOP RIGHT COIN DISPLAY =====
                const coinDisplay = new PIXI.Container();
                coinDisplay.x = CONFIG.width - 80;
                coinDisplay.y = 25;
                stage.addChild(coinDisplay);

                const coinBg = new PIXI.Graphics();
                coinBg.roundRect(-50, -15, 100, 30, 15);
                coinBg.fill(0x3a3a5a);
                coinDisplay.addChild(coinBg);

                const coinIcon = new PIXI.Text({ text: 'ðŸª™', style: { fontSize: 22 } });
                coinIcon.anchor.set(0.5);
                coinIcon.x = -35;
                coinDisplay.addChild(coinIcon);

                const coinAmount = new PIXI.Text({
                    text: '1460',
                    style: { fontFamily: 'Arial', fontSize: 16, fontWeight: 'bold', fill: COLORS.textWhite }
                });
                coinAmount.anchor.set(0, 0.5);
                coinAmount.x = -18;
                coinDisplay.addChild(coinAmount);

                const plusBtn = new PIXI.Graphics();
                plusBtn.circle(35, 0, 12);
                plusBtn.fill(0xf0ad4e);
                coinDisplay.addChild(plusBtn);

                const plusText = new PIXI.Text({
                    text: '+',
                    style: { fontFamily: 'Arial', fontSize: 18, fontWeight: 'bold', fill: COLORS.textWhite }
                });
                plusText.anchor.set(0.5);
                plusText.x = 35;
                coinDisplay.addChild(plusText);

                // ===== MAIN PANEL (Blue rounded rectangle) =====
                const panelY = 100;
                const panelWidth = 300;
                const panelHeight = 480;

                // Panel outer border (dark)
                const panelBorder = new PIXI.Graphics();
                panelBorder.roundRect(centerX - panelWidth/2 - 5, panelY - 5, panelWidth + 10, panelHeight + 10, 25);
                panelBorder.fill(COLORS.panelBorder);
                stage.addChild(panelBorder);

                // Panel main background (gradient effect with multiple layers)
                const panelBg = new PIXI.Graphics();
                panelBg.roundRect(centerX - panelWidth/2, panelY, panelWidth, panelHeight, 20);
                panelBg.fill(COLORS.panelBg);
                stage.addChild(panelBg);

                // Panel top highlight
                const panelHighlight = new PIXI.Graphics();
                panelHighlight.roundRect(centerX - panelWidth/2 + 5, panelY + 5, panelWidth - 10, panelHeight/3, 18);
                panelHighlight.fill({ color: COLORS.panelLight, alpha: 0.3 });
                stage.addChild(panelHighlight);

                // ===== TROPHY WITH LIGHT RAYS =====
                const trophyY = panelY - 30;

                // Light rays behind trophy
                const trophyRays = new PIXI.Graphics();
                const rayCount = 16;
                for (let i = 0; i < rayCount; i++) {
                    const angle = (i / rayCount) * Math.PI * 2;
                    const nextAngle = ((i + 0.4) / rayCount) * Math.PI * 2;
                    trophyRays.moveTo(0, 0);
                    trophyRays.lineTo(Math.cos(angle) * 120, Math.sin(angle) * 120);
                    trophyRays.lineTo(Math.cos(nextAngle) * 120, Math.sin(nextAngle) * 120);
                    trophyRays.fill({ color: 0xFFFFFF, alpha: 0.15 });
                }
                trophyRays.x = centerX;
                trophyRays.y = trophyY + 40;
                stage.addChild(trophyRays);

                // Trophy glow
                const trophyGlow = new PIXI.Graphics();
                trophyGlow.circle(0, 0, 50);
                trophyGlow.fill({ color: 0xFFD700, alpha: 0.4 });
                trophyGlow.x = centerX;
                trophyGlow.y = trophyY + 40;
                stage.addChild(trophyGlow);

                // Trophy emoji
                const trophy = new PIXI.Text({ text: 'ðŸ†', style: { fontSize: 72 } });
                trophy.anchor.set(0.5);
                trophy.x = centerX;
                trophy.y = trophyY + 40;
                stage.addChild(trophy);

                // Animate rays rotation
                game.on('update', () => {
                    trophyRays.rotation += 0.003;
                });

                // ===== LEVEL COMPLETED RIBBON/BANNER =====
                const ribbonY = panelY + 100;

                // Ribbon background (blue banner shape)
                const ribbon = new PIXI.Graphics();
                // Main ribbon body
                ribbon.roundRect(centerX - 120, ribbonY, 240, 55, 5);
                ribbon.fill(COLORS.ribbonBlue);
                // Left ribbon end
                ribbon.moveTo(centerX - 130, ribbonY + 5);
                ribbon.lineTo(centerX - 120, ribbonY + 5);
                ribbon.lineTo(centerX - 120, ribbonY + 50);
                ribbon.lineTo(centerX - 130, ribbonY + 50);
                ribbon.lineTo(centerX - 120, ribbonY + 27);
                ribbon.fill(COLORS.ribbonDark);
                // Right ribbon end
                ribbon.moveTo(centerX + 130, ribbonY + 5);
                ribbon.lineTo(centerX + 120, ribbonY + 5);
                ribbon.lineTo(centerX + 120, ribbonY + 50);
                ribbon.lineTo(centerX + 130, ribbonY + 50);
                ribbon.lineTo(centerX + 120, ribbonY + 27);
                ribbon.fill(COLORS.ribbonDark);
                stage.addChild(ribbon);

                // Ribbon highlight
                const ribbonHighlight = new PIXI.Graphics();
                ribbonHighlight.roundRect(centerX - 115, ribbonY + 3, 230, 20, 3);
                ribbonHighlight.fill({ color: 0xFFFFFF, alpha: 0.2 });
                stage.addChild(ribbonHighlight);

                // "LEVEL 20" text
                const levelText = new PIXI.Text({
                    text: 'LEVEL 20',
                    style: {
                        fontFamily: 'Arial',
                        fontSize: 22,
                        fontWeight: 'bold',
                        fill: COLORS.textWhite,
                        dropShadow: true,
                        dropShadowColor: 0x000000,
                        dropShadowDistance: 2,
                        dropShadowBlur: 2
                    }
                });
                levelText.anchor.set(0.5);
                levelText.x = centerX;
                levelText.y = ribbonY + 18;
                stage.addChild(levelText);

                // "COMPLETED!" text
                const completedText = new PIXI.Text({
                    text: 'COMPLETED!',
                    style: {
                        fontFamily: 'Arial',
                        fontSize: 14,
                        fontWeight: 'bold',
                        fill: COLORS.textWhite,
                        dropShadow: true,
                        dropShadowColor: 0x000000,
                        dropShadowDistance: 1,
                        dropShadowBlur: 1
                    }
                });
                completedText.anchor.set(0.5);
                completedText.x = centerX;
                completedText.y = ribbonY + 40;
                stage.addChild(completedText);

                // ===== REWARDS SECTION =====
                const rewardsY = ribbonY + 80;

                // "REWARDS" title with stroke effect
                const rewardsTitle = new PIXI.Text({
                    text: 'REWARDS',
                    style: {
                        fontFamily: 'Arial',
                        fontSize: 20,
                        fontWeight: 'bold',
                        fill: COLORS.textWhite,
                        stroke: { color: COLORS.textOutline, width: 4 }
                    }
                });
                rewardsTitle.anchor.set(0.5);
                rewardsTitle.x = centerX;
                rewardsTitle.y = rewardsY;
                stage.addChild(rewardsTitle);

                // ===== REWARD PANEL (inner blue panel) =====
                const rewardPanelY = rewardsY + 25;
                const rewardPanelWidth = 260;
                const rewardPanelHeight = 140;

                // Reward panel border
                const rewardBorder = new PIXI.Graphics();
                rewardBorder.roundRect(centerX - rewardPanelWidth/2 - 3, rewardPanelY - 3, rewardPanelWidth + 6, rewardPanelHeight + 6, 15);
                rewardBorder.fill(COLORS.panelBorder);
                stage.addChild(rewardBorder);

                // Reward panel background
                const rewardPanel = new PIXI.Graphics();
                rewardPanel.roundRect(centerX - rewardPanelWidth/2, rewardPanelY, rewardPanelWidth, rewardPanelHeight, 12);
                rewardPanel.fill(COLORS.panelLight);
                stage.addChild(rewardPanel);

                // Light rays behind coin
                const coinRays = new PIXI.Graphics();
                const coinRayCount = 20;
                for (let i = 0; i < coinRayCount; i++) {
                    const angle = (i / coinRayCount) * Math.PI * 2;
                    const nextAngle = ((i + 0.3) / coinRayCount) * Math.PI * 2;
                    coinRays.moveTo(0, 0);
                    coinRays.lineTo(Math.cos(angle) * 80, Math.sin(angle) * 80);
                    coinRays.lineTo(Math.cos(nextAngle) * 80, Math.sin(nextAngle) * 80);
                    coinRays.fill({ color: 0xFFFFFF, alpha: 0.2 });
                }
                coinRays.x = centerX;
                coinRays.y = rewardPanelY + 55;
                stage.addChild(coinRays);

                // Animate coin rays
                game.on('update', () => {
                    coinRays.rotation -= 0.005;
                });

                // Coin container (for shimmer)
                const rewardCoinContainer = new PIXI.Container();
                rewardCoinContainer.x = centerX;
                rewardCoinContainer.y = rewardPanelY + 50;
                stage.addChild(rewardCoinContainer);

                // Large coin emoji
                const rewardCoin = new PIXI.Text({ text: 'ðŸª™', style: { fontSize: 56 } });
                rewardCoin.anchor.set(0.5);
                rewardCoinContainer.addChild(rewardCoin);

                // Add shimmer to coin
                setTimeout(() => {
                    celebration.addShimmer(rewardCoinContainer, 'gold');
                }, 500);

                // Reward amount "40" with stroke
                const rewardAmount = new PIXI.Text({
                    text: '40',
                    style: {
                        fontFamily: 'Arial',
                        fontSize: 36,
                        fontWeight: 'bold',
                        fill: COLORS.textWhite,
                        stroke: { color: COLORS.textOutline, width: 5 }
                    }
                });
                rewardAmount.anchor.set(0.5);
                rewardAmount.x = centerX;
                rewardAmount.y = rewardPanelY + 110;
                stage.addChild(rewardAmount);

                // ===== BUTTONS =====
                const btnY = rewardPanelY + rewardPanelHeight + 30;
                const btnWidth = 120;
                const btnHeight = 50;
                const btnGap = 20;

                // Continue button (green)
                const continueBtnShadow = new PIXI.Graphics();
                continueBtnShadow.roundRect(centerX - btnWidth - btnGap/2, btnY + 4, btnWidth, btnHeight, 12);
                continueBtnShadow.fill(COLORS.greenBtnDark);
                stage.addChild(continueBtnShadow);

                const continueBtn = new PIXI.Graphics();
                continueBtn.roundRect(centerX - btnWidth - btnGap/2, btnY, btnWidth, btnHeight, 12);
                continueBtn.fill(COLORS.greenBtn);
                continueBtn.eventMode = 'static';
                continueBtn.cursor = 'pointer';
                stage.addChild(continueBtn);

                // Button highlight
                const continueBtnHighlight = new PIXI.Graphics();
                continueBtnHighlight.roundRect(centerX - btnWidth - btnGap/2 + 5, btnY + 3, btnWidth - 10, 15, 8);
                continueBtnHighlight.fill({ color: 0xFFFFFF, alpha: 0.3 });
                stage.addChild(continueBtnHighlight);

                const continueText = new PIXI.Text({
                    text: 'Continue',
                    style: {
                        fontFamily: 'Arial',
                        fontSize: 18,
                        fontWeight: 'bold',
                        fill: COLORS.textWhite,
                        dropShadow: true,
                        dropShadowColor: 0x000000,
                        dropShadowDistance: 1,
                        dropShadowBlur: 1
                    }
                });
                continueText.anchor.set(0.5);
                continueText.x = centerX - btnWidth/2 - btnGap/2;
                continueText.y = btnY + btnHeight/2;
                stage.addChild(continueText);

                // Watch Ad button (orange)
                const adBtnShadow = new PIXI.Graphics();
                adBtnShadow.roundRect(centerX + btnGap/2, btnY + 4, btnWidth, btnHeight, 12);
                adBtnShadow.fill(COLORS.orangeBtnDark);
                stage.addChild(adBtnShadow);

                const adBtn = new PIXI.Graphics();
                adBtn.roundRect(centerX + btnGap/2, btnY, btnWidth, btnHeight, 12);
                adBtn.fill(COLORS.orangeBtn);
                adBtn.eventMode = 'static';
                adBtn.cursor = 'pointer';
                stage.addChild(adBtn);

                // Ad button highlight
                const adBtnHighlight = new PIXI.Graphics();
                adBtnHighlight.roundRect(centerX + btnGap/2 + 5, btnY + 3, btnWidth - 10, 15, 8);
                adBtnHighlight.fill({ color: 0xFFFFFF, alpha: 0.3 });
                stage.addChild(adBtnHighlight);

                // Video icon
                const videoIcon = new PIXI.Text({ text: 'ðŸŽ¬', style: { fontSize: 18 } });
                videoIcon.anchor.set(0.5);
                videoIcon.x = centerX + btnGap/2 + 20;
                videoIcon.y = btnY + btnHeight/2;
                stage.addChild(videoIcon);

                // "80" text
                const adAmountText = new PIXI.Text({
                    text: '80',
                    style: {
                        fontFamily: 'Arial',
                        fontSize: 16,
                        fontWeight: 'bold',
                        fill: COLORS.textWhite,
                        dropShadow: true,
                        dropShadowColor: 0x000000,
                        dropShadowDistance: 1,
                        dropShadowBlur: 1
                    }
                });
                adAmountText.anchor.set(0.5);
                adAmountText.x = centerX + btnGap/2 + 55;
                adAmountText.y = btnY + btnHeight/2 - 5;
                stage.addChild(adAmountText);

                // Small coin and x2 badge
                const smallCoin = new PIXI.Text({ text: 'ðŸª™', style: { fontSize: 14 } });
                smallCoin.anchor.set(0.5);
                smallCoin.x = centerX + btnGap/2 + 80;
                smallCoin.y = btnY + btnHeight/2 - 5;
                stage.addChild(smallCoin);

                const x2Badge = new PIXI.Text({
                    text: 'x2',
                    style: { fontFamily: 'Arial', fontSize: 10, fontWeight: 'bold', fill: 0xFFD700 }
                });
                x2Badge.anchor.set(0.5);
                x2Badge.x = centerX + btnGap/2 + 100;
                x2Badge.y = btnY + btnHeight/2 + 5;
                stage.addChild(x2Badge);

                // ===== CONFETTI CELEBRATION =====
                setTimeout(() => {
                    celebration.victory();
                }, 300);

                // Button hover effects
                continueBtn.on('pointerover', () => continueBtn.tint = 0xccffcc);
                continueBtn.on('pointerout', () => continueBtn.tint = 0xffffff);
                adBtn.on('pointerover', () => adBtn.tint = 0xffffcc);
                adBtn.on('pointerout', () => adBtn.tint = 0xffffff);
            }

            // Game loop for celebration updates
            game.on('update', (deltaTime) => {
                celebration.update(deltaTime);
            });

            createVictoryScreen();
            game.start();
        })();
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Result Screen Demo - GameByte Framework</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { overflow: hidden; background: #1a1a2e; }
        canvas { display: block; margin: 0 auto; }
        #controls {
            position: fixed;
            top: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 15px;
            border-radius: 8px;
            font-family: Arial, sans-serif;
            font-size: 14px;
            z-index: 1000;
        }
        #controls button {
            display: block;
            width: 100%;
            margin: 5px 0;
            padding: 10px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }
        #controls button:hover {
            background: #45a049;
        }
        #controls button.defeat {
            background: #E84C4C;
        }
        #controls button.defeat:hover {
            background: #d43f3f;
        }
    </style>
</head>
<body>
    <!-- Control Panel -->
    <div id="controls">
        <div style="margin-bottom: 10px; font-weight: bold;">Result Screen Demo</div>
        <button onclick="showVictory()">Show Victory Screen</button>
        <button class="defeat" onclick="showDefeat()">Show Defeat Screen</button>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/pixi.js@8/dist/pixi.min.js"></script>
    <script src="/gamebyte.umd.js"></script>

    <script>
        // =====================================================
        // Result Screen Demo - GameByte Framework Component
        // =====================================================
        // This demo showcases the ResultScreen framework component:
        // - Victory and Defeat screens
        // - Star rating system (0-3)
        // - Score display with best score tracking
        // - Reward items with icons
        // - Action buttons with callbacks
        // - Proper framework integration
        // =====================================================

        const { createGame, ResultScreen, loadFrameworkFont } = GameByteFramework;

        const CONFIG = { width: 360, height: 700 };

        const canvas = document.createElement('canvas');
        canvas.width = CONFIG.width;
        canvas.height = CONFIG.height;
        document.body.appendChild(canvas);

        const game = createGame();
        let currentScreen = null;

        // Sample game state
        let gameState = {
            score: 12450,
            bestScore: 15230,
            stars: 3
        };

        /**
         * Show victory screen
         */
        function showVictory() {
            // Remove current screen if exists
            if (currentScreen) {
                const stage = game.make('renderer').getStage();
                stage.removeChild(currentScreen.getContainer());
            }

            // Create victory screen with rewards and actions
            const resultScreen = new ResultScreen({
                type: 'victory',
                score: gameState.score,
                bestScore: gameState.bestScore,
                stars: gameState.stars,
                rewards: [
                    { icon: 'ðŸ’°', amount: 500, label: 'Coins' },
                    { icon: 'ðŸ’Ž', amount: 10, label: 'Gems' }
                ],
                actions: [
                    {
                        text: 'Continue',
                        style: 'primary',
                        onClick: () => {
                            console.log('Continue clicked');
                            // Simulate next level
                            gameState.score = Math.floor(Math.random() * 20000);
                            gameState.stars = Math.floor(Math.random() * 4);
                            showVictory();
                        }
                    },
                    {
                        text: 'Double Reward',
                        style: 'secondary',
                        onClick: () => {
                            console.log('Double Reward clicked - Watch Ad');
                            alert('In a real game, this would show a rewarded video ad');
                        }
                    }
                ]
            });

            // Resize to fit canvas
            resultScreen.resize(CONFIG.width, CONFIG.height);

            // Add to stage
            const stage = game.make('renderer').getStage();
            stage.addChild(resultScreen.getContainer());

            currentScreen = resultScreen;

            console.log('Victory screen displayed:', {
                score: gameState.score,
                bestScore: gameState.bestScore,
                stars: gameState.stars
            });
        }

        /**
         * Show defeat screen
         */
        function showDefeat() {
            // Remove current screen if exists
            if (currentScreen) {
                const stage = game.make('renderer').getStage();
                stage.removeChild(currentScreen.getContainer());
            }

            // Create defeat screen
            const resultScreen = new ResultScreen({
                type: 'defeat',
                score: gameState.score,
                bestScore: gameState.bestScore,
                stars: 0,
                actions: [
                    {
                        text: 'Retry',
                        style: 'primary',
                        onClick: () => {
                            console.log('Retry clicked');
                            // Simulate retry
                            gameState.score = Math.floor(Math.random() * 10000);
                            gameState.stars = Math.floor(Math.random() * 3);
                            showDefeat();
                        }
                    },
                    {
                        text: 'Main Menu',
                        style: 'secondary',
                        onClick: () => {
                            console.log('Main Menu clicked');
                            alert('In a real game, this would return to main menu');
                        }
                    }
                ]
            });

            // Resize to fit canvas
            resultScreen.resize(CONFIG.width, CONFIG.height);

            // Add to stage
            const stage = game.make('renderer').getStage();
            stage.addChild(resultScreen.getContainer());

            currentScreen = resultScreen;

            console.log('Defeat screen displayed:', {
                score: gameState.score,
                bestScore: gameState.bestScore
            });
        }

        // Initialize
        (async () => {
            await loadFrameworkFont();
            await game.initialize(canvas, '2d');

            // Show initial victory screen
            showVictory();

            // Start game loop
            game.start();
        })();

        // Expose functions globally for button controls
        window.showVictory = showVictory;
        window.showDefeat = showDefeat;
    </script>
</body>
</html>
